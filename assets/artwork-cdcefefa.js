import{o as i,c as r,b as e,g as F,r as g,k as W,l as R,a as m,i as f,m as c,t as d,d as h,n as $,F as S,h as z,_ as q,w as x,v as _,p as L,f as G,e as K,u as Q,V as X}from"./index-a521c2ea.js";import{r as Y}from"./HeartIcon-4c2889f6.js";function Z(j,l){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12.75l6 6 9-13.5"})])}function ee(j,l){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})])}function te(j,l){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})])}function se(j,l){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})])}function oe(j,l){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})])}const ne={class:"fixed left-0 top-0 right-0 bottom-0 flex justify-center overflow-x-hidden overflow-y-scroll"},le={key:0,class:"md:flex md:justify-center md:items-center py-10"},ae={class:"mr-0 md:mr-5"},ie={class:"w-[300px] bg-stone-100 p-2 shadow-xl"},re=["href"],ue=["src"],ce={class:"flex py-3 text-xs text-white"},de={key:0,class:"bg-red-800/80 px-2 py-1"},pe={key:1,class:"bg-green-800/80 px-2 py-1"},ve={key:2,class:"bg-blue-800/80 px-2 py-1"},ge={class:"bg-gray-400/80 px-2 py-1 text-black/80"},me={class:"w-[300px] text-stone-900/80 ml-0 mt-5 md:ml-5 md:mt-0"},fe={class:"flex items-center"},he={class:"flex-1"},xe={class:"font-bold"},_e={class:"text-sm"},ke={key:0,class:"mt-2 text-xs flex"},we={key:1,class:"mt-2 text-xs flex flex-wrap"},be=["onClick"],ye={class:"text-xs mt-5"},$e={class:"text-xs mt-5 text-stone-900/50"},je={class:"grid grid-cols-3 text-xs mt-5"},Ce={class:"col-span-2"},Oe=e("div",{class:"text-stone-900/50"},"模型",-1),Se=e("div",{class:"text-stone-900/50"},"文本强度",-1),Be={class:"grid grid-cols-3 text-xs mt-5"},Ae={class:"col-span-2"},Ne=e("div",{class:"text-stone-900/50"},"采样器",-1),Ve=e("div",{class:"text-stone-900/50"},"步数",-1),Me={key:2,class:"text-xs mt-5 pb-5 text-stone-900/50 flex flex-row-reverse"},Ue={key:0,class:"z-20 fixed top-0 bottom-0 left-0 w-[60px] flex flex-col justify-center items-center"},ze={key:1,class:"z-20 fixed top-0 bottom-0 right-0 w-[60px] flex flex-col justify-center items-center"},Le={key:2,class:"z-50 fixed left-0 top-0 right-0 bottom-0 bg-black/80 text-stone-100/80"},Je={class:"fixed w-full md:w-[600px] top-[80px] right-0 bottom-0 px-5 bg-stone-600 text-sm"},Te={class:"mb-5 grid grid-cols-3 gap-2"},Pe={class:"col-span-2"},De=e("div",{class:"my-1"},"作品名称",-1),Ee={class:"bg-stone-700/80"},He=e("div",{class:"my-1"},"署名",-1),Ie={class:"bg-stone-700/80"},Fe={class:"mb-5"},We=e("div",{class:"my-1"},"提示词",-1),Re={class:"bg-stone-700/80"},qe={class:"mb-5"},Ge=e("div",{class:"my-1"},"负性提示词",-1),Ke={class:"bg-stone-700/80"},Qe={class:"mb-5"},Xe=e("div",{class:"my-1"},"平台或工具",-1),Ye={class:"flex"},Ze={class:"mb-5 grid grid-cols-3 gap-2"},et={class:"col-span-2"},tt=e("div",{class:"my-1"},"模型名称",-1),st={class:"bg-stone-700/80"},ot=e("div",{class:"my-1"},"文本强度",-1),nt={class:"bg-stone-700/80"},lt={class:"mb-5 grid grid-cols-3 gap-2"},at={class:"col-span-2"},it=e("div",{class:"my-1"},"采样器",-1),rt={class:"bg-stone-700/80"},ut=e("div",{class:"my-1"},"步数",-1),ct={class:"bg-stone-700/80"},dt={class:"mb-5 grid grid-cols-3 gap-2 items-end"},pt={class:"col-span-2"},vt=e("div",{class:"my-1"},"随机种子",-1),gt={class:"bg-stone-700/80"},mt={class:"text-right"},ft={class:"fixed w-full md:w-[600px] top-0 right-0 h-[80px] flex items-center px-5 bg-stone-600"},ht=e("div",{class:"flex-1 text-lg font-bold"},"编辑作品信息",-1),xt={__name:"artwork",setup(j){const{proxy:l}=F(),p=g(!!l.$cookies.get("intelli-token")),B=l.$cookies.get("intelli-artwork"),u=g(l.$cookies.get("intelli-competition")),A=g(l.$cookies.get("intelli-competitions")),T=g(l.$cookies.get("intelli-artist")==l.$cookies.get("intelli-username")),t=g({}),k=g(!1),b=g(),w=g(!1),C=g(!1),n=g({title:"",artist:"",prompt:"",negative:"",platform:"mj",model:"",scale:7,sampler:"",step:20,seed:0});var v=[];W(()=>{window.addEventListener("keydown",N)}),R(()=>{window.removeEventListener("keydown",N)});function N(s){s.key=="ArrowRight"?M():s.key=="ArrowLeft"&&V()}const y=()=>{n.value.title=t.value.param.title,n.value.artist=t.value.param.artist,n.value.prompt=t.value.param.prompt,n.value.negative=t.value.param.negative,n.value.platform=t.value.param.platform,n.value.model=t.value.param.model,n.value.scale=t.value.param.scale,n.value.sampler=t.value.param.sampler,n.value.step=t.value.param.step,n.value.seed=t.value.param.seed},V=()=>{p.value?m.post(l.$util.settings.api+"/intelli/my/prev/artwork",JSON.stringify({sn:t.value.sn,cp:u.value}),{headers:{Authorization:"Bearer "+l.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.hasOwnProperty("sn")?(t.value=s.data,y(),k.value=v.indexOf(t.value.sn)!=-1,l.$cookies.set("intelli-artwork",t.value.sn)):b.value.show("前面没有了",1e3)}).catch(function(s){console.log(s)}):m.post(l.$util.settings.api+"/intelli/prev/artwork",JSON.stringify({sn:t.value.sn,cp:u.value}),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.hasOwnProperty("sn")?(t.value=s.data,y(),k.value=v.indexOf(t.value.sn)!=-1,l.$cookies.set("intelli-artwork",t.value.sn)):b.value.show("前面没有了",1e3)}).catch(function(s){console.log(s)})},M=()=>{p.value?m.post(l.$util.settings.api+"/intelli/my/next/artwork",JSON.stringify({sn:t.value.sn,cp:u.value}),{headers:{Authorization:"Bearer "+l.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.hasOwnProperty("sn")?(t.value=s.data,y(),k.value=v.indexOf(t.value.sn)!=-1,l.$cookies.set("intelli-artwork",t.value.sn)):b.value.show("后面没有了",1e3)}).catch(function(s){console.log(s)}):m.post(l.$util.settings.api+"/intelli/next/artwork",JSON.stringify({sn:t.value.sn,cp:u.value}),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.hasOwnProperty("sn")?(t.value=s.data,y(),k.value=v.indexOf(t.value.sn)!=-1,l.$cookies.set("intelli-artwork",t.value.sn)):b.value.show("后面没有了",1e3)}).catch(function(s){console.log(s)})},U=()=>{p.value?m.post(l.$util.settings.api+"/intelli/artwork2",JSON.stringify({sn:B}),{headers:{Authorization:"Bearer "+l.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){t.value=s.data.artwork,y(),t.value.competition.length&&!u.value&&(u.value=t.value.competition[0]),v=s.data.favorite,k.value=v.indexOf(t.value.sn)!=-1}).catch(function(s){console.log(s)}):m.post(l.$util.settings.api+"/intelli/artwork",JSON.stringify({sn:B}),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(function(s){t.value=s.data,y(),t.value.competition.length&&!u.value&&(u.value=t.value.competition[0])}).catch(function(s){console.log(s)})},P=()=>{if(!p.value)return b.value.show("您尚未登录，请登录后试试看"),!1;m.post(l.$util.settings.api+"/intelli/artwork/toggle/like",JSON.stringify({sn:t.value.sn}),{headers:{Authorization:"Bearer "+l.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.res=="ok"&&(v.indexOf(t.value.sn)==-1?(v.push(t.value.sn),k.value=!0,t.value.like++):(v.splice(v.indexOf(t.value.sn),1),k.value=!1,t.value.like--))}).catch(function(s){console.log(s)})},D=s=>{if(t.value.competition.indexOf(s)==-1&&t.value.competition.length>2)return b.value.show("每幅作品最多投稿到三个分类"),!1;m.post(l.$util.settings.api+"/intelli/my/artwork/toggle/competition",JSON.stringify({sn:t.value.sn,cp:s}),{headers:{Authorization:"Bearer "+l.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&(t.value.competition.indexOf(s)>=0?t.value.competition.splice(t.value.competition.indexOf(s),1):t.value.competition.push(s))}).catch(function(o){console.log(o)})},E=s=>{if(!w.value)return w.value=!0,!1;m.post(l.$util.settings.api+"/intelli/my/artwork/remove",JSON.stringify({sn:t.value.sn}),{headers:{Authorization:"Bearer "+l.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&l.$util.gotoPage("gallery")}).catch(function(o){console.log(o)})},H=()=>{m.post(l.$util.settings.api+"/intelli/my/artwork/update",JSON.stringify({sn:t.value.sn,cp:JSON.stringify(n.value)}),{headers:{Authorization:"Bearer "+l.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.res=="ok"&&(C.value=!1,U())}).catch(function(s){console.log(s)})},I=s=>{p.value=s};return U(),(s,o)=>(i(),r(S,null,[e("div",ne,[t.value.sn?(i(),r("div",le,[e("div",ae,[e("div",ie,[e("a",{href:f(l).$util.settings.api+"/d/image/"+t.value.file,target:"_blank"},[e("img",{ref:"demo",src:f(l).$util.settings.api+"/d/image/"+t.value.file,class:"shadow-inner"},null,8,ue)],8,re)]),e("div",ce,[n.value.platform=="mj"?(i(),r("div",de,"Midjourney")):c("",!0),n.value.platform=="sd"?(i(),r("div",pe,"SD WebUI")):c("",!0),n.value.platform=="ot"?(i(),r("div",ve,"其它")):c("",!0),e("div",ge,d(n.value.seed?n.value.seed:"-"),1)])]),e("div",me,[e("div",fe,[e("div",he,[e("div",xe,d(t.value.param.title),1),e("div",_e,d(t.value.param.artist),1)]),e("button",{class:"flex items-center",onClick:o[0]||(o[0]=a=>P())},[h(f(Y),{class:$([p.value&&k.value?"text-red-600":"","w-5 h-5 mr-2"])},null,8,["class"]),e("div",null,d(t.value.like),1)])]),!p.value||p.value&&u.value!="gallery"?(i(),r("div",ke,[(i(!0),r(S,null,z(t.value.competition,a=>(i(),r("div",{class:"bg-stone-300 px-1 m-1",key:a},d(A.value[a].split(" / ")[0]),1))),128))])):c("",!0),p.value&&u.value=="gallery"?(i(),r("div",we,[(i(!0),r(S,null,z(A.value,(a,O)=>(i(),r("button",{key:O,class:$([t.value.competition.indexOf(O)>=0?"bg-stone-400":"bg-stone-300","px-1 m-1"]),onClick:_t=>D(O)},d(a.split(" / ")[0]),11,be))),128))])):c("",!0),e("div",ye,d(t.value.param.prompt),1),e("div",$e,d(t.value.param.negative),1),e("div",je,[e("div",Ce,[Oe,e("div",null,d(n.value.model?n.value.model:"-"),1)]),e("div",null,[Se,e("div",null,d(n.value.scale?n.value.scale:"-"),1)])]),e("div",Be,[e("div",Ae,[Ne,e("div",null,d(n.value.sampler?n.value.sampler:"-"),1)]),e("div",null,[Ve,e("div",null,d(n.value.step?n.value.step:"-"),1)])]),T.value?(i(),r("div",Me,[w.value?(i(),r("button",{key:0,class:"p-2 rounded-full hover:bg-stone-300/50",onClick:o[1]||(o[1]=a=>w.value=!1)},[h(f(L),{class:"w-5 h-5"})])):c("",!0),w.value?(i(),r("button",{key:1,class:"p-2 rounded-full hover:bg-stone-300/50",onClick:o[2]||(o[2]=a=>E())},[h(f(Z),{class:"w-5 h-5"})])):c("",!0),e("button",{class:$([w.value?"text-red-600":"","p-2 rounded-full hover:bg-stone-300/50"]),onClick:o[3]||(o[3]=a=>w.value=!w.value)},[h(f(oe),{class:"w-5 h-5"})],2),e("button",{class:"p-2 rounded-full hover:bg-stone-300/50 mr-2",onClick:o[4]||(o[4]=a=>C.value=!0)},[h(f(se),{class:"w-5 h-5"})])])):c("",!0)])])):c("",!0)]),u.value?(i(),r("div",Ue,[e("button",{class:"bg-stone-200/50 p-3 rounded-full hover:bg-stone-300",onClick:o[5]||(o[5]=a=>V())},[h(f(ee),{class:"w-5 h-5 text-stone-600"})])])):c("",!0),u.value?(i(),r("div",ze,[e("button",{class:"bg-stone-200/50 p-3 rounded-full hover:bg-stone-300",onClick:o[6]||(o[6]=a=>M())},[h(f(te),{class:"w-5 h-5 text-stone-600"})])])):c("",!0),h(q,{page:u.value,autohide:"true",signup:p.value,onUpdateStatus:I,onShowMessage:s.showMessage},null,8,["page","signup","onShowMessage"]),C.value?(i(),r("div",Le,[e("div",Je,[e("div",Te,[e("div",Pe,[De,e("div",Ee,[x(e("input",{"onUpdate:modelValue":o[7]||(o[7]=a=>n.value.title=a),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.title]])])]),e("div",null,[He,e("div",Ie,[x(e("input",{"onUpdate:modelValue":o[8]||(o[8]=a=>n.value.artist=a),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.artist]])])])]),e("div",Fe,[We,e("div",Re,[x(e("input",{"onUpdate:modelValue":o[9]||(o[9]=a=>n.value.prompt=a),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.prompt]])])]),e("div",qe,[Ge,e("div",Ke,[x(e("input",{"onUpdate:modelValue":o[10]||(o[10]=a=>n.value.negative=a),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.negative]])])]),e("div",Qe,[Xe,e("div",Ye,[e("button",{class:$([n.value.platform=="mj"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:o[11]||(o[11]=a=>n.value.platform="mj")},"Midjourney",2),e("button",{class:$([n.value.platform=="sd"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:o[12]||(o[12]=a=>n.value.platform="sd")},"SD WebUI",2),e("button",{class:$([n.value.platform=="ot"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:o[13]||(o[13]=a=>n.value.platform="ot")},"其它",2)])]),e("div",Ze,[e("div",et,[tt,e("div",st,[x(e("input",{"onUpdate:modelValue":o[14]||(o[14]=a=>n.value.model=a),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.model]])])]),e("div",null,[ot,e("div",nt,[x(e("input",{"onUpdate:modelValue":o[15]||(o[15]=a=>n.value.scale=a),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.scale]])])])]),e("div",lt,[e("div",at,[it,e("div",rt,[x(e("input",{"onUpdate:modelValue":o[16]||(o[16]=a=>n.value.sampler=a),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.sampler]])])]),e("div",null,[ut,e("div",ct,[x(e("input",{"onUpdate:modelValue":o[17]||(o[17]=a=>n.value.step=a),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.step]])])])]),e("div",dt,[e("div",pt,[vt,e("div",gt,[x(e("input",{"onUpdate:modelValue":o[18]||(o[18]=a=>n.value.seed=a),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.seed]])])]),e("div",mt,[e("button",{class:"py-2 px-5 text-lf font-bold bg-stone-800 hover:bg-stone-900",onClick:o[19]||(o[19]=a=>H())},"确认修改")])])]),e("div",ft,[ht,e("button",{onClick:o[20]||(o[20]=a=>C.value=!1)},[h(f(L),{class:"w-7 h-7"})])])])):c("",!0),h(G,{ref_key:"message",ref:b},null,512)],64))}},J=K(xt);J.config.globalProperties.$util=Q;J.use(X).mount("#app");
