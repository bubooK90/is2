import{o as a,c as n,a as e,g as R,r as m,m as G,p as K,e as k,f as v,i as f,t as d,b as p,n as w,F as B,l as J,w as x,v as h,_ as Q,j as X,q as Y,s as Z,x as M,k as ee,d as te,u as se}from"./PageHeader-d12ea756.js";import{r as oe}from"./EyeIcon-6231c18e.js";function le(y,u){return a(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12.75l6 6 9-13.5"})])}function ae(y,u){return a(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})])}function ne(y,u){return a(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})])}function ie(y,u){return a(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})])}function re(y,u){return a(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})])}const de={class:"fixed left-0 top-0 right-0 bottom-0 md:flex md:justify-center overflow-x-hidden overflow-y-scroll"},ue=e("div",{class:"h-[120px] w-full md:hidden"},null,-1),ce={class:"flex justify-center"},ve={key:0,class:"md:flex md:justify-center md:items-center py-10"},pe={class:"mr-0 md:mr-5"},me={class:"w-[300px] bg-stone-100 p-2 shadow-xl"},fe=["href"],ge=["src"],xe={class:"flex items-center py-3 text-xs text-white font-mono"},he={key:0,class:"bg-red-800/80 px-2 py-1"},we={key:1,class:"bg-green-800/80 px-2 py-1"},_e={key:2,class:"bg-blue-800/80 px-2 py-1"},be=e("div",{class:"flex-1"},null,-1),ke={class:"text-right bg-stone-300/80 px-2 py-1 text-black/80"},ye={class:"w-[300px] text-stone-900/80 ml-0 mt-5 md:ml-5 md:mt-0"},$e={class:"font-bold"},Ce={class:"flex items-center"},Se={class:"flex-1 text-sm"},je={class:"mt-2 flex flex-row-reverse items-center text-xs font-mono"},Oe={class:"flex items-center mr-2"},Ne={class:"mt-2 text-xs flex"},Ae={class:"grid grid-cols-3 text-xs mt-5"},Be={class:"col-span-2"},Ue=e("div",{class:"text-stone-900/50"},"模型",-1),Ve=e("div",{class:"text-stone-900/50"},"文本强度",-1),Le={class:"grid grid-cols-3 text-xs mt-5"},Je={class:"col-span-2"},Me=e("div",{class:"text-stone-900/50"},"采样器",-1),Ie=e("div",{class:"text-stone-900/50"},"步数",-1),ze={key:0,class:"text-xs mt-5 pb-5 text-stone-900/50 flex"},Te=e("div",{class:"flex-1"},null,-1),De={class:"fixed top-0 bottom-0 left-0 w-[60px] flex flex-col justify-center items-center"},Ee={class:"fixed top-0 bottom-0 right-0 w-[60px] flex flex-col justify-center items-center"},Fe={key:0,class:"z-50 fixed left-0 top-0 right-0 bottom-0 bg-black/80 text-stone-100/80"},He={class:"fixed w-full md:w-[600px] top-[80px] right-0 bottom-0 px-5 pb-10 bg-stone-600 text-sm overflow-x-hidden overflow-y-scroll"},Pe={class:"mb-5 grid grid-cols-3 gap-2"},We={class:"col-span-2"},qe=e("div",{class:"my-1"},"作品名称",-1),Re={class:"bg-stone-700/80"},Ge=e("div",{class:"my-1"},"署名",-1),Ke={class:"bg-stone-700/80"},Qe={class:"col-span-3"},Xe=e("div",{class:"my-1"},"参赛类别",-1),Ye={class:"flex flex-wrap"},Ze=["onClick"],et={class:"mb-5"},tt=e("div",{class:"my-1"},"提示词",-1),st={class:"bg-stone-700/80"},ot={class:"mb-5"},lt=e("div",{class:"my-1"},"负性提示词",-1),at={class:"bg-stone-700/80"},nt={class:"mb-5"},it=e("div",{class:"my-1"},"平台或工具",-1),rt={class:"flex"},dt={class:"mb-5 grid grid-cols-3 gap-2"},ut={class:"col-span-2"},ct=e("div",{class:"my-1"},"模型名称",-1),vt={class:"bg-stone-700/80"},pt=e("div",{class:"my-1"},"文本强度",-1),mt={class:"bg-stone-700/80"},ft={class:"mb-5 grid grid-cols-3 gap-2"},gt={class:"col-span-2"},xt=e("div",{class:"my-1"},"采样器",-1),ht={class:"bg-stone-700/80"},wt=e("div",{class:"my-1"},"步数",-1),_t={class:"bg-stone-700/80"},bt={class:"mb-5 grid grid-cols-3 gap-2 items-end"},kt={class:"col-span-2"},yt=e("div",{class:"my-1"},"随机种子",-1),$t={class:"bg-stone-700/80"},Ct={class:"text-right"},St={class:"fixed w-full md:w-[600px] top-0 right-0 h-[80px] flex items-center px-5 bg-stone-600"},jt=e("div",{class:"flex-1 text-lg font-bold"},"编辑作品信息",-1),Ot={__name:"artwork",setup(y){const{proxy:u}=R(),c=m(!!localStorage.token);var i=localStorage.artwork;const $=localStorage.waterfall.split(","),z=m(JSON.parse(localStorage.competitions)),r=m(localStorage.profile?JSON.parse(localStorage.profile):{}),T=m(JSON.parse(localStorage.competitions)),t=m({}),C=m(!1),S=m(c.value?r.value.like.indexOf(i)>=0:!1),j=m(c.value?r.value.collection.indexOf(i)>=0:!1),g=m(),_=m(!1),b=m(!1);G(()=>{window.addEventListener("keydown",U)}),K(()=>{window.removeEventListener("keydown",U)});function U(o){o.key=="ArrowRight"?L():o.key=="ArrowLeft"&&V()}const V=()=>{var o=$.indexOf(i);o?(i=$[o-1],localStorage.setItem("artwork",i),O()):g.value.show("前面没有了",1e3)},L=()=>{var o=$.indexOf(i);o<$.length-1?(i=$[o+1],localStorage.setItem("artwork",i),O()):g.value.show("后面没有了",1e3)},O=()=>{k.get(u.$util.settings.api+"/artwork/"+i,{headers:{accept:"application/json"}}).then(function(o){o.data.res=="ok"?(t.value=o.data.artwork,c.value&&(S.value=r.value.like.indexOf(i)>=0,j.value=r.value.collection.indexOf(i)>=0,C.value=r.value.follow.indexOf(t.value.owner)>=0)):o.data.res=="error"}).catch(function(o){console.log(o)})},D=()=>{if(!c.value)return g.value.show("您尚未登录，请登录后试试看"),!1;k.put(u.$util.settings.api+"/artwork/update/"+i,JSON.stringify({competition:t.value.competition,param:t.value.param}),{headers:{Authorization:"Bearer "+localStorage.token,accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&(b.value=!1,g.value.show("作品信息已更新"))}).catch(function(o){console.log(o)})},E=()=>{if(!c.value)return g.value.show("您尚未登录，请登录后试试看"),!1;k.put(u.$util.settings.api+"/artwork/remove/"+i,JSON.stringify({}),{headers:{Authorization:"Bearer "+localStorage.token,accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&u.$util.gotoPage()}).catch(function(o){console.log(o)})},F=()=>{if(!c.value)return g.value.show("您尚未登录，请登录后试试看"),!1;k.put(u.$util.settings.api+"/artwork/like/"+i,JSON.stringify({}),{headers:{Authorization:"Bearer "+localStorage.token,accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&(console.log(o.data),S.value=o.data.like,S.value?(r.value.like.push(i),t.value.liked++):(r.value.like.splice(r.value.like.indexOf(i),1),t.value.liked--),localStorage.setItem("profile",JSON.stringify(r.value)))}).catch(function(o){console.log(o)})},H=()=>{if(!c.value)return g.value.show("您尚未登录，请登录后试试看"),!1;k.put(u.$util.settings.api+"/my/follow/"+t.value.owner,JSON.stringify({}),{headers:{Authorization:"Bearer "+localStorage.token,accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&(console.log(o.data),C.value=o.data.follow,C.value?r.value.follow.push(t.value.owner):r.value.follow.splice(r.value.follow.indexOf(t.value.owner),1),localStorage.setItem("profile",JSON.stringify(r.value)))}).catch(function(o){console.log(o)})},P=()=>{if(!c.value)return g.value.show("您尚未登录，请登录后试试看"),!1;k.put(u.$util.settings.api+"/artwork/collect/"+i,JSON.stringify({}),{headers:{Authorization:"Bearer "+localStorage.token,accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&(console.log(o.data),j.value=o.data.collect,j.value?(r.value.collection.push(i),t.value.collected++):(r.value.collection.splice(r.value.collection.indexOf(i),1),t.value.collected--),localStorage.setItem("profile",JSON.stringify(r.value)))}).catch(function(o){console.log(o)})},W=o=>{t.value.competition.indexOf(o)>=0?t.value.competition.splice(t.value.competition.indexOf(o),1):t.value.competition.push(o)},N=async o=>{try{await navigator.clipboard.writeText(t.value.param[o]),o=o=="negative"?o+" prompt":o,g.value.show("已将 "+o+" 拷贝到剪贴板")}catch(s){console.log(s)}},q=o=>{c.value=o};return O(),(o,s)=>(a(),n(B,null,[e("div",de,[ue,e("div",ce,[t.value.sn?(a(),n("div",ve,[e("div",pe,[e("div",me,[e("a",{href:v(u).$util.settings.img+t.value.file,target:"_blank"},[e("img",{ref:"demo",src:v(u).$util.settings.img+t.value.file,class:"shadow-inner"},null,8,ge)],8,fe)]),e("div",xe,[t.value.param.platform=="mj"?(a(),n("div",he,"Midjourney")):f("",!0),t.value.param.platform=="sd"?(a(),n("div",we,"SD WebUI")):f("",!0),t.value.param.platform=="ot"?(a(),n("div",_e,"其它")):f("",!0),t.value.param.seed?(a(),n("div",{key:3,class:"bg-stone-300/80 px-2 py-1 text-black/80 can-copy",onClick:s[0]||(s[0]=l=>N("seed"))},d(t.value.param.seed),1)):f("",!0),be,e("div",ke,d(t.value.width)+"x"+d(t.value.height),1)])]),e("div",ye,[e("div",$e,d(t.value.param.title),1),e("div",Ce,[e("div",Se,d(t.value.param.artist),1),c.value&&t.value.owner!=r.value.username?(a(),n("button",{key:0,class:"flex items-center text-xs",onClick:s[1]||(s[1]=l=>H())},[p(v(X),{class:w([C.value?"text-red-600":"","w-4 h-4 mr-1"])},null,8,["class"]),e("div",null,d(C.value?"取关":"关注"),1)])):f("",!0)]),e("div",je,[e("button",{class:"flex items-center",onClick:s[2]||(s[2]=l=>P())},[p(v(Y),{class:w([c.value&&j.value?"text-red-600":"","w-4 h-4 mr-1"])},null,8,["class"]),e("div",null,d(t.value.collected),1)]),e("button",{class:"flex items-center mr-2",onClick:s[3]||(s[3]=l=>F())},[p(v(Z),{class:w([c.value&&S.value?"text-red-600":"","w-4 h-4 mr-1"])},null,8,["class"]),e("div",null,d(t.value.liked),1)]),e("div",Oe,[p(v(oe),{class:"w-4 h-4 mr-1"}),e("div",null,d(t.value.viewed),1)])]),e("div",Ne,[(a(!0),n(B,null,J(t.value.competition,l=>(a(),n("div",{class:"bg-stone-300 px-1 m-1",key:l},d(z.value[l].name),1))),128))]),e("div",{class:"text-xs mt-3 can-copy",onClick:s[4]||(s[4]=l=>N("prompt"))},d(t.value.param.prompt),1),e("div",{class:"text-xs mt-3 text-stone-900/50 can-copy",onClick:s[5]||(s[5]=l=>N("negative"))},d(t.value.param.negative),1),e("div",Ae,[e("div",Be,[Ue,e("div",null,d(t.value.param.model?t.value.param.model:"-"),1)]),e("div",null,[Ve,e("div",null,d(t.value.param.scale?t.value.param.scale:"-"),1)])]),e("div",Le,[e("div",Je,[Me,e("div",null,d(t.value.param.sampler?t.value.param.sampler:"-"),1)]),e("div",null,[Ie,e("div",null,d(t.value.param.step?t.value.param.step:"-"),1)])]),c.value&&t.value.owner==r.value.username?(a(),n("div",ze,[Te,e("button",{class:"p-2 rounded-full mr-2",onClick:s[6]||(s[6]=l=>b.value=!0)},[p(v(ie),{class:"w-5 h-5"})]),e("button",{class:w([_.value?"text-red-600":"","p-2 rounded-full"]),onClick:s[7]||(s[7]=l=>_.value=!_.value)},[p(v(re),{class:"w-5 h-5"})],2),_.value?(a(),n("button",{key:0,class:"p-2 rounded-full",onClick:s[8]||(s[8]=l=>E())},[p(v(le),{class:"w-5 h-5"})])):f("",!0),_.value?(a(),n("button",{key:1,class:"p-2 rounded-full",onClick:s[9]||(s[9]=l=>_.value=!1)},[p(v(M),{class:"w-5 h-5"})])):f("",!0)])):f("",!0)])])):f("",!0)])]),e("div",De,[e("button",{class:"bg-stone-200/50 p-3 rounded-full hover:bg-stone-300",onClick:s[10]||(s[10]=l=>V())},[p(v(ae),{class:"w-5 h-5 text-stone-600"})])]),e("div",Ee,[e("button",{class:"bg-stone-200/50 p-3 rounded-full hover:bg-stone-300",onClick:s[11]||(s[11]=l=>L())},[p(v(ne),{class:"w-5 h-5 text-stone-600"})])]),b.value?(a(),n("div",Fe,[b.value?(a(),n("div",{key:0,class:"fixed left-0 top-0 bottom-0 right-[600px]",onClick:s[12]||(s[12]=l=>b.value=!1)})):f("",!0),e("div",He,[e("div",Pe,[e("div",We,[qe,e("div",Re,[x(e("input",{"onUpdate:modelValue":s[13]||(s[13]=l=>t.value.param.title=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.title]])])]),e("div",null,[Ge,e("div",Ke,[x(e("input",{"onUpdate:modelValue":s[14]||(s[14]=l=>t.value.param.artist=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.artist]])])]),e("div",Qe,[Xe,e("div",Ye,[(a(!0),n(B,null,J(T.value,(l,A)=>(a(),n("button",{key:A,class:w([t.value.competition.indexOf(A)>=0?"bg-stone-800":"bg-stone-700/80","px-2 py-1 hover:bg-stone-800/70"]),onClick:Nt=>W(A)},d(l.name),11,Ze))),128))])])]),e("div",et,[tt,e("div",st,[x(e("input",{"onUpdate:modelValue":s[15]||(s[15]=l=>t.value.param.prompt=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.prompt]])])]),e("div",ot,[lt,e("div",at,[x(e("input",{"onUpdate:modelValue":s[16]||(s[16]=l=>t.value.param.negative=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.negative]])])]),e("div",nt,[it,e("div",rt,[e("button",{class:w([t.value.param.platform=="mj"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:s[17]||(s[17]=l=>t.value.param.platform="mj")},"Midjourney",2),e("button",{class:w([t.value.param.platform=="sd"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:s[18]||(s[18]=l=>t.value.param.platform="sd")},"SD WebUI",2),e("button",{class:w([t.value.param.platform=="ot"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:s[19]||(s[19]=l=>t.value.param.platform="ot")},"其它",2)])]),e("div",dt,[e("div",ut,[ct,e("div",vt,[x(e("input",{"onUpdate:modelValue":s[20]||(s[20]=l=>t.value.param.model=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.model]])])]),e("div",null,[pt,e("div",mt,[x(e("input",{"onUpdate:modelValue":s[21]||(s[21]=l=>t.value.param.scale=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.scale]])])])]),e("div",ft,[e("div",gt,[xt,e("div",ht,[x(e("input",{"onUpdate:modelValue":s[22]||(s[22]=l=>t.value.param.sampler=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.sampler]])])]),e("div",null,[wt,e("div",_t,[x(e("input",{"onUpdate:modelValue":s[23]||(s[23]=l=>t.value.param.step=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.step]])])])]),e("div",bt,[e("div",kt,[yt,e("div",$t,[x(e("input",{"onUpdate:modelValue":s[24]||(s[24]=l=>t.value.param.seed=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.seed]])])]),e("div",Ct,[e("button",{class:"py-2 px-5 text-lf font-bold bg-stone-800 hover:bg-stone-900",onClick:s[25]||(s[25]=l=>D())},"确认修改")])])]),e("div",St,[jt,e("button",{onClick:s[26]||(s[26]=l=>b.value=!1)},[p(v(M),{class:"w-7 h-7"})])])])):f("",!0),p(Q,{signin:c.value,onUpdateStatus:q},null,8,["signin"]),p(ee,{ref_key:"message",ref:g},null,512)],64))}},I=te(Ot);I.config.globalProperties.$util=se;I.mount("#app");
