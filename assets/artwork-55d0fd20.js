import{o as a,c as n,a as e,g as G,r as m,m as K,p as Q,e as k,f as v,i as f,t as d,b as p,n as _,F as U,l as I,w as x,v as h,_ as X,j as Y,q as Z,s as ee,x as M,k as te,d as se,u as oe}from"./PageHeader-2c069531.js";import{r as le}from"./EyeIcon-c005c884.js";import{r as ae}from"./CheckIcon-3f968837.js";function ne(S,c){return a(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})])}function ie(S,c){return a(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})])}function re(S,c){return a(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})])}function de(S,c){return a(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})])}const ue={class:"fixed left-0 top-0 right-0 bottom-0 md:flex md:justify-center overflow-x-hidden overflow-y-scroll"},ce=e("div",{class:"h-[120px] w-full md:hidden"},null,-1),ve={class:"flex justify-center"},pe={key:0,class:"md:flex md:justify-center md:items-center py-10"},me={class:"mr-0 md:mr-5"},fe={class:"w-[300px] bg-stone-100 p-2 shadow-xl relative"},ge=["href"],xe=["src"],he={key:0,class:"absolute left-0 top-0 right-0 bottom-0 flex items-center"},_e=e("div",{class:"w-full bg-red-500 text-white text-sm font-bold text-center py-2"},"作品尚未通过审核",-1),we=[_e],be={class:"flex items-center py-3 text-xs text-white font-mono"},ke={key:0,class:"bg-red-800/80 px-2 py-1"},ye={key:1,class:"bg-green-800/80 px-2 py-1"},$e={key:2,class:"bg-blue-800/80 px-2 py-1"},Se=e("div",{class:"flex-1"},null,-1),Ce={class:"text-right bg-stone-300/80 px-2 py-1 text-black/80"},je={class:"w-[300px] text-stone-900/80 ml-0 mt-5 md:ml-5 md:mt-0"},Oe={class:"font-bold"},Ne={class:"flex items-center"},Ae={class:"flex-1 text-sm"},Be={class:"mt-2 flex flex-row-reverse items-center text-xs font-mono"},Ue={class:"flex items-center mr-2"},Ve={class:"mt-2 text-xs flex"},Je={class:"grid grid-cols-3 text-xs mt-5"},Le={class:"col-span-2"},Ie=e("div",{class:"text-stone-900/50"},"模型",-1),Me=e("div",{class:"text-stone-900/50"},"文本强度",-1),ze={class:"grid grid-cols-3 text-xs mt-5"},Te={class:"col-span-2"},De=e("div",{class:"text-stone-900/50"},"采样器",-1),Ee=e("div",{class:"text-stone-900/50"},"步数",-1),Fe={key:0,class:"text-xs mt-5 pb-5 text-stone-900/50 flex"},He=e("div",{class:"flex-1"},null,-1),Pe={class:"fixed top-0 bottom-0 left-0 w-[60px] flex flex-col justify-center items-center"},We={class:"fixed top-0 bottom-0 right-0 w-[60px] flex flex-col justify-center items-center"},qe={key:0,class:"z-50 fixed left-0 top-0 right-0 bottom-0 bg-black/80 text-stone-100/80"},Re={class:"fixed w-full md:w-[600px] top-[80px] right-0 bottom-0 px-5 pb-10 bg-stone-600 text-sm overflow-x-hidden overflow-y-scroll"},Ge={class:"mb-5 grid grid-cols-3 gap-2"},Ke={class:"col-span-2"},Qe=e("div",{class:"my-1"},"作品名称",-1),Xe={class:"bg-stone-700/80"},Ye=e("div",{class:"my-1"},"署名",-1),Ze={class:"bg-stone-700/80"},et={class:"col-span-3"},tt=e("div",{class:"my-1"},"参赛类别",-1),st={class:"flex flex-wrap"},ot=["onClick"],lt={class:"mb-5"},at=e("div",{class:"my-1"},"提示词",-1),nt={class:"bg-stone-700/80"},it={class:"mb-5"},rt=e("div",{class:"my-1"},"负性提示词",-1),dt={class:"bg-stone-700/80"},ut={class:"mb-5"},ct=e("div",{class:"my-1"},"平台或工具",-1),vt={class:"flex"},pt={class:"mb-5 grid grid-cols-3 gap-2"},mt={class:"col-span-2"},ft=e("div",{class:"my-1"},"模型名称",-1),gt={class:"bg-stone-700/80"},xt=e("div",{class:"my-1"},"文本强度",-1),ht={class:"bg-stone-700/80"},_t={class:"mb-5 grid grid-cols-3 gap-2"},wt={class:"col-span-2"},bt=e("div",{class:"my-1"},"采样器",-1),kt={class:"bg-stone-700/80"},yt=e("div",{class:"my-1"},"步数",-1),$t={class:"bg-stone-700/80"},St={class:"mb-5 grid grid-cols-3 gap-2 items-end"},Ct={class:"col-span-2"},jt=e("div",{class:"my-1"},"随机种子",-1),Ot={class:"bg-stone-700/80"},Nt={class:"text-right"},At={class:"fixed w-full md:w-[600px] top-0 right-0 h-[80px] flex items-center px-5 bg-stone-600"},Bt=e("div",{class:"flex-1 text-lg font-bold"},"编辑作品信息",-1),Ut={__name:"artwork",setup(S){const{proxy:c}=G(),u=m(!!localStorage.token);var i=localStorage.artwork;const y=localStorage.waterfall.split(","),T=m(JSON.parse(localStorage.competitions)),r=m(localStorage.profile?JSON.parse(localStorage.profile):{}),D=m(JSON.parse(localStorage.competitions)),t=m({}),$=m(!1),C=m(u.value?r.value.like.indexOf(i)>=0:!1),j=m(u.value?r.value.collection.indexOf(i)>=0:!1),g=m(),w=m(!1),b=m(!1),O=m(!0);K(()=>{window.addEventListener("keydown",V)}),Q(()=>{window.removeEventListener("keydown",V)});function V(o){o.key=="ArrowRight"?L():o.key=="ArrowLeft"&&J()}const J=()=>{var o=y.indexOf(i);o?(i=y[o-1],localStorage.setItem("artwork",i),N()):g.value.show("前面没有了",1e3)},L=()=>{var o=y.indexOf(i);o<y.length-1?(i=y[o+1],localStorage.setItem("artwork",i),N()):g.value.show("后面没有了",1e3)},N=()=>{k.put(c.$util.settings.api+"/artwork/"+i,JSON.stringify({token:localStorage.getItem("token")?localStorage.getItem("token"):""}),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(function(o){t.value={},o.data.res=="ok"?(t.value=o.data.artwork,O.value=!!t.value.disabled,u.value&&(C.value=r.value.like.indexOf(i)>=0,j.value=r.value.collection.indexOf(i)>=0,$.value=r.value.follow.indexOf(t.value.owner)>=0)):o.data.res=="error"&&(O.value=!0)}).catch(function(o){console.log(o)})},E=()=>{if(!u.value)return g.value.show("您尚未登录，请登录后试试看"),!1;k.put(c.$util.settings.api+"/artwork/update/"+i,JSON.stringify({competition:t.value.competition,param:t.value.param}),{headers:{Authorization:"Bearer "+localStorage.token,accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&(b.value=!1,g.value.show("作品信息已更新"),O.value=o.data.disabled)}).catch(function(o){console.log(o)})},F=()=>{if(!u.value)return g.value.show("您尚未登录，请登录后试试看"),!1;k.put(c.$util.settings.api+"/artwork/remove/"+i,JSON.stringify({}),{headers:{Authorization:"Bearer "+localStorage.token,accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&c.$util.gotoPage()}).catch(function(o){console.log(o)})},H=()=>{if(!u.value)return g.value.show("您尚未登录，请登录后试试看"),!1;k.put(c.$util.settings.api+"/artwork/like/"+i,JSON.stringify({}),{headers:{Authorization:"Bearer "+localStorage.token,accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&(C.value=o.data.like,C.value?(r.value.like.push(i),t.value.liked++):(r.value.like.splice(r.value.like.indexOf(i),1),t.value.liked--),localStorage.setItem("profile",JSON.stringify(r.value)))}).catch(function(o){console.log(o)})},P=()=>{if(!u.value)return g.value.show("您尚未登录，请登录后试试看"),!1;k.put(c.$util.settings.api+"/my/follow/"+t.value.owner,JSON.stringify({}),{headers:{Authorization:"Bearer "+localStorage.token,accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&($.value=o.data.follow,$.value?r.value.follow.push(t.value.owner):r.value.follow.splice(r.value.follow.indexOf(t.value.owner),1),localStorage.setItem("profile",JSON.stringify(r.value)))}).catch(function(o){console.log(o)})},W=()=>{if(!u.value)return g.value.show("您尚未登录，请登录后试试看"),!1;k.put(c.$util.settings.api+"/artwork/collect/"+i,JSON.stringify({}),{headers:{Authorization:"Bearer "+localStorage.token,accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&(j.value=o.data.collect,j.value?(r.value.collection.push(i),t.value.collected++):(r.value.collection.splice(r.value.collection.indexOf(i),1),t.value.collected--),localStorage.setItem("profile",JSON.stringify(r.value)))}).catch(function(o){console.log(o)})},q=o=>{t.value.competition.indexOf(o)>=0?t.value.competition.splice(t.value.competition.indexOf(o),1):t.value.competition.push(o)},A=async o=>{try{await navigator.clipboard.writeText(t.value.param[o]),o=o=="negative"?o+" prompt":o,g.value.show("已将 "+o+" 拷贝到剪贴板")}catch(s){console.log(s)}},R=o=>{u.value=o};return N(),(o,s)=>(a(),n(U,null,[e("div",ue,[ce,e("div",ve,[t.value.sn?(a(),n("div",pe,[e("div",me,[e("div",fe,[e("a",{href:v(c).$util.settings.img+t.value.file,target:"_blank"},[e("img",{ref:"demo",src:v(c).$util.settings.img+t.value.file,class:"shadow-inner"},null,8,xe)],8,ge),O.value?(a(),n("div",he,we)):f("",!0)]),e("div",be,[t.value.param.platform=="mj"?(a(),n("div",ke,"Midjourney")):f("",!0),t.value.param.platform=="sd"?(a(),n("div",ye,"SD WebUI")):f("",!0),t.value.param.platform=="ot"?(a(),n("div",$e,"其它")):f("",!0),t.value.param.seed?(a(),n("div",{key:3,class:"bg-stone-300/80 px-2 py-1 text-black/80 can-copy",onClick:s[0]||(s[0]=l=>A("seed"))},d(t.value.param.seed),1)):f("",!0),Se,e("div",Ce,d(t.value.width)+"x"+d(t.value.height),1)])]),e("div",je,[e("div",Oe,d(t.value.param.title),1),e("div",Ne,[e("div",Ae,d(t.value.param.artist),1),u.value&&t.value.owner!=r.value.username?(a(),n("button",{key:0,class:"flex items-center text-xs",onClick:s[1]||(s[1]=l=>P())},[p(v(Y),{class:_([$.value?"text-red-600":"","w-4 h-4 mr-1"])},null,8,["class"]),e("div",null,d($.value?"取关":"关注"),1)])):f("",!0)]),e("div",Be,[e("button",{class:"flex items-center",onClick:s[2]||(s[2]=l=>W())},[p(v(Z),{class:_([u.value&&j.value?"text-red-600":"","w-4 h-4 mr-1"])},null,8,["class"]),e("div",null,d(t.value.collected),1)]),e("button",{class:"flex items-center mr-2",onClick:s[3]||(s[3]=l=>H())},[p(v(ee),{class:_([u.value&&C.value?"text-red-600":"","w-4 h-4 mr-1"])},null,8,["class"]),e("div",null,d(t.value.liked),1)]),e("div",Ue,[p(v(le),{class:"w-4 h-4 mr-1"}),e("div",null,d(t.value.viewed),1)])]),e("div",Ve,[(a(!0),n(U,null,I(t.value.competition,l=>(a(),n("div",{class:"bg-stone-300 px-1 m-1",key:l},d(T.value[l].name),1))),128))]),e("div",{class:"text-xs mt-3 can-copy",onClick:s[4]||(s[4]=l=>A("prompt"))},d(t.value.param.prompt),1),e("div",{class:"text-xs mt-3 text-stone-900/50 can-copy",onClick:s[5]||(s[5]=l=>A("negative"))},d(t.value.param.negative),1),e("div",Je,[e("div",Le,[Ie,e("div",null,d(t.value.param.model?t.value.param.model:"-"),1)]),e("div",null,[Me,e("div",null,d(t.value.param.scale?t.value.param.scale:"-"),1)])]),e("div",ze,[e("div",Te,[De,e("div",null,d(t.value.param.sampler?t.value.param.sampler:"-"),1)]),e("div",null,[Ee,e("div",null,d(t.value.param.step?t.value.param.step:"-"),1)])]),u.value&&t.value.owner==r.value.username?(a(),n("div",Fe,[He,e("button",{class:"p-2 rounded-full mr-2",onClick:s[6]||(s[6]=l=>b.value=!0)},[p(v(re),{class:"w-5 h-5"})]),e("button",{class:_([w.value?"text-red-600":"","p-2 rounded-full"]),onClick:s[7]||(s[7]=l=>w.value=!w.value)},[p(v(de),{class:"w-5 h-5"})],2),w.value?(a(),n("button",{key:0,class:"p-2 rounded-full",onClick:s[8]||(s[8]=l=>F())},[p(v(ae),{class:"w-5 h-5"})])):f("",!0),w.value?(a(),n("button",{key:1,class:"p-2 rounded-full",onClick:s[9]||(s[9]=l=>w.value=!1)},[p(v(M),{class:"w-5 h-5"})])):f("",!0)])):f("",!0)])])):f("",!0)])]),e("div",Pe,[e("button",{class:"bg-stone-200/50 p-3 rounded-full hover:bg-stone-300",onClick:s[10]||(s[10]=l=>J())},[p(v(ne),{class:"w-5 h-5 text-stone-600"})])]),e("div",We,[e("button",{class:"bg-stone-200/50 p-3 rounded-full hover:bg-stone-300",onClick:s[11]||(s[11]=l=>L())},[p(v(ie),{class:"w-5 h-5 text-stone-600"})])]),b.value?(a(),n("div",qe,[b.value?(a(),n("div",{key:0,class:"fixed left-0 top-0 bottom-0 right-[600px]",onClick:s[12]||(s[12]=l=>b.value=!1)})):f("",!0),e("div",Re,[e("div",Ge,[e("div",Ke,[Qe,e("div",Xe,[x(e("input",{"onUpdate:modelValue":s[13]||(s[13]=l=>t.value.param.title=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.title]])])]),e("div",null,[Ye,e("div",Ze,[x(e("input",{"onUpdate:modelValue":s[14]||(s[14]=l=>t.value.param.artist=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.artist]])])]),e("div",et,[tt,e("div",st,[(a(!0),n(U,null,I(D.value,(l,B)=>(a(),n("button",{key:B,class:_([t.value.competition.indexOf(B)>=0?"bg-stone-800":"bg-stone-700/80","px-2 py-1 hover:bg-stone-800/70"]),onClick:Vt=>q(B)},d(l.name),11,ot))),128))])])]),e("div",lt,[at,e("div",nt,[x(e("input",{"onUpdate:modelValue":s[15]||(s[15]=l=>t.value.param.prompt=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.prompt]])])]),e("div",it,[rt,e("div",dt,[x(e("input",{"onUpdate:modelValue":s[16]||(s[16]=l=>t.value.param.negative=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.negative]])])]),e("div",ut,[ct,e("div",vt,[e("button",{class:_([t.value.param.platform=="mj"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:s[17]||(s[17]=l=>t.value.param.platform="mj")},"Midjourney",2),e("button",{class:_([t.value.param.platform=="sd"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:s[18]||(s[18]=l=>t.value.param.platform="sd")},"SD WebUI",2),e("button",{class:_([t.value.param.platform=="ot"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:s[19]||(s[19]=l=>t.value.param.platform="ot")},"其它",2)])]),e("div",pt,[e("div",mt,[ft,e("div",gt,[x(e("input",{"onUpdate:modelValue":s[20]||(s[20]=l=>t.value.param.model=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.model]])])]),e("div",null,[xt,e("div",ht,[x(e("input",{"onUpdate:modelValue":s[21]||(s[21]=l=>t.value.param.scale=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.scale]])])])]),e("div",_t,[e("div",wt,[bt,e("div",kt,[x(e("input",{"onUpdate:modelValue":s[22]||(s[22]=l=>t.value.param.sampler=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.sampler]])])]),e("div",null,[yt,e("div",$t,[x(e("input",{"onUpdate:modelValue":s[23]||(s[23]=l=>t.value.param.step=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.step]])])])]),e("div",St,[e("div",Ct,[jt,e("div",Ot,[x(e("input",{"onUpdate:modelValue":s[24]||(s[24]=l=>t.value.param.seed=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[h,t.value.param.seed]])])]),e("div",Nt,[e("button",{class:"py-2 px-5 text-lf font-bold bg-stone-800 hover:bg-stone-900",onClick:s[25]||(s[25]=l=>E())},"确认修改")])])]),e("div",At,[Bt,e("button",{onClick:s[26]||(s[26]=l=>b.value=!1)},[p(v(M),{class:"w-7 h-7"})])])])):f("",!0),p(X,{signin:u.value,onUpdateStatus:R},null,8,["signin"]),p(te,{ref_key:"message",ref:g},null,512)],64))}},z=se(Ut);z.config.globalProperties.$util=oe;z.mount("#app");
