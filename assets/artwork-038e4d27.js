import{o as i,c as r,b as e,g as I,r as h,k as F,l as W,a as g,i as m,m as d,t as c,d as f,n as $,F as S,h as z,_ as R,w as x,v as _,p as L,f as q,e as G,u as K,V as Q}from"./index-e46bce11.js";import{r as X}from"./HeartIcon-941a6a75.js";function Y(j,a){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12.75l6 6 9-13.5"})])}function Z(j,a){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})])}function ee(j,a){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})])}function te(j,a){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})])}function se(j,a){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})])}const oe={class:"fixed left-0 top-0 right-0 bottom-0 flex justify-center overflow-x-hidden overflow-y-scroll"},ne={key:0,class:"md:flex md:justify-center md:items-center py-10"},le={class:"mr-0 md:mr-5"},ae={class:"w-[300px] bg-stone-100 p-2 shadow-xl"},ie=["href"],re=["src"],ue={class:"flex py-3 text-xs text-white"},ce={key:0,class:"bg-red-800/80 px-2 py-1"},de={key:1,class:"bg-green-800/80 px-2 py-1"},pe={key:2,class:"bg-blue-800/80 px-2 py-1"},ve={class:"bg-gray-400/80 px-2 py-1 text-black/80"},ge={class:"w-[300px] text-stone-900/80 ml-0 mt-5 md:ml-5 md:mt-0"},me={class:"flex items-center"},fe={class:"flex-1"},he={class:"font-bold"},xe={class:"text-sm"},_e={key:0,class:"mt-2 text-xs flex"},ke={key:1,class:"mt-2 text-xs flex flex-wrap"},we=["onClick"],be={class:"text-xs mt-5"},ye={class:"text-xs mt-5 text-stone-900/50"},$e={class:"grid grid-cols-3 text-xs mt-5"},je={class:"col-span-2"},Ce=e("div",{class:"text-stone-900/50"},"模型",-1),Oe=e("div",{class:"text-stone-900/50"},"文本强度",-1),Se={class:"grid grid-cols-3 text-xs mt-5"},Be={class:"col-span-2"},Ae=e("div",{class:"text-stone-900/50"},"采样器",-1),Ne=e("div",{class:"text-stone-900/50"},"步数",-1),Ve={class:"text-xs mt-5 pb-5 text-stone-900/50 flex flex-row-reverse"},Ue={key:0,class:"z-20 fixed top-0 bottom-0 left-0 w-[60px] flex flex-col justify-center items-center"},Me={key:1,class:"z-20 fixed top-0 bottom-0 right-0 w-[60px] flex flex-col justify-center items-center"},ze={key:2,class:"z-50 fixed left-0 top-0 right-0 bottom-0 bg-black/80 text-stone-100/80"},Le={class:"fixed w-full md:w-[600px] top-[80px] right-0 bottom-0 px-5 bg-stone-600 text-sm"},Je={class:"mb-5 grid grid-cols-3 gap-2"},Te={class:"col-span-2"},Pe=e("div",{class:"my-1"},"作品名称",-1),De={class:"bg-stone-700/80"},Ee=e("div",{class:"my-1"},"署名",-1),He={class:"bg-stone-700/80"},Ie={class:"mb-5"},Fe=e("div",{class:"my-1"},"提示词",-1),We={class:"bg-stone-700/80"},Re={class:"mb-5"},qe=e("div",{class:"my-1"},"负性提示词",-1),Ge={class:"bg-stone-700/80"},Ke={class:"mb-5"},Qe=e("div",{class:"my-1"},"平台或工具",-1),Xe={class:"flex"},Ye={class:"mb-5 grid grid-cols-3 gap-2"},Ze={class:"col-span-2"},et=e("div",{class:"my-1"},"模型名称",-1),tt={class:"bg-stone-700/80"},st=e("div",{class:"my-1"},"文本强度",-1),ot={class:"bg-stone-700/80"},nt={class:"mb-5 grid grid-cols-3 gap-2"},lt={class:"col-span-2"},at=e("div",{class:"my-1"},"采样器",-1),it={class:"bg-stone-700/80"},rt=e("div",{class:"my-1"},"步数",-1),ut={class:"bg-stone-700/80"},ct={class:"mb-5 grid grid-cols-3 gap-2 items-end"},dt={class:"col-span-2"},pt=e("div",{class:"my-1"},"随机种子",-1),vt={class:"bg-stone-700/80"},gt={class:"text-right"},mt={class:"fixed w-full md:w-[600px] top-0 right-0 h-[80px] flex items-center px-5 bg-stone-600"},ft=e("div",{class:"flex-1 text-lg font-bold"},"编辑作品信息",-1),ht={__name:"artwork",setup(j){const{proxy:a}=I(),p=h(!!a.$cookies.get("intelli-token")),B=a.$cookies.get("intelli-artwork"),u=h(a.$cookies.get("intelli-competition")),A=h(a.$cookies.get("intelli-competitions")),t=h({}),k=h(!1),b=h(),w=h(!1),C=h(!1),n=h({title:"",artist:"",prompt:"",negative:"",platform:"mj",model:"",scale:7,sampler:"",step:20,seed:0});var v=[];F(()=>{window.addEventListener("keydown",N)}),W(()=>{window.removeEventListener("keydown",N)});function N(s){s.key=="ArrowRight"?U():s.key=="ArrowLeft"&&V()}const y=()=>{n.value.title=t.value.param.title,n.value.artist=t.value.param.artist,n.value.prompt=t.value.param.prompt,n.value.negative=t.value.param.negative,n.value.platform=t.value.param.platform,n.value.model=t.value.param.model,n.value.scale=t.value.param.scale,n.value.sampler=t.value.param.sampler,n.value.step=t.value.param.step,n.value.seed=t.value.param.seed},V=()=>{p.value?g.post(a.$util.settings.api+"/intelli/my/prev/artwork",JSON.stringify({sn:t.value.sn,cp:u.value}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.hasOwnProperty("sn")?(t.value=s.data,y(),k.value=v.indexOf(t.value.sn)!=-1,a.$cookies.set("intelli-artwork",t.value.sn)):b.value.show("前面没有了",1e3)}).catch(function(s){console.log(s)}):g.post(a.$util.settings.api+"/intelli/prev/artwork",JSON.stringify({sn:t.value.sn,cp:u.value}),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.hasOwnProperty("sn")?(t.value=s.data,y(),k.value=v.indexOf(t.value.sn)!=-1,a.$cookies.set("intelli-artwork",t.value.sn)):b.value.show("前面没有了",1e3)}).catch(function(s){console.log(s)})},U=()=>{p.value?g.post(a.$util.settings.api+"/intelli/my/next/artwork",JSON.stringify({sn:t.value.sn,cp:u.value}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.hasOwnProperty("sn")?(t.value=s.data,y(),k.value=v.indexOf(t.value.sn)!=-1,a.$cookies.set("intelli-artwork",t.value.sn)):b.value.show("后面没有了",1e3)}).catch(function(s){console.log(s)}):g.post(a.$util.settings.api+"/intelli/next/artwork",JSON.stringify({sn:t.value.sn,cp:u.value}),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.hasOwnProperty("sn")?(t.value=s.data,y(),k.value=v.indexOf(t.value.sn)!=-1,a.$cookies.set("intelli-artwork",t.value.sn)):b.value.show("后面没有了",1e3)}).catch(function(s){console.log(s)})},M=()=>{p.value?g.post(a.$util.settings.api+"/intelli/artwork2",JSON.stringify({sn:B}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){t.value=s.data.artwork,y(),t.value.competition.length&&!u.value&&(u.value=t.value.competition[0]),v=s.data.favorite,k.value=v.indexOf(t.value.sn)!=-1}).catch(function(s){console.log(s)}):g.post(a.$util.settings.api+"/intelli/artwork",JSON.stringify({sn:B}),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(function(s){t.value=s.data,y(),t.value.competition.length&&!u.value&&(u.value=t.value.competition[0])}).catch(function(s){console.log(s)})},T=()=>{if(!p.value)return b.value.show("您尚未登录，请登录后试试看"),!1;g.post(a.$util.settings.api+"/intelli/artwork/toggle/like",JSON.stringify({sn:t.value.sn}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.res=="ok"&&(v.indexOf(t.value.sn)==-1?(v.push(t.value.sn),k.value=!0,t.value.like++):(v.splice(v.indexOf(t.value.sn),1),k.value=!1,t.value.like--))}).catch(function(s){console.log(s)})},P=s=>{if(t.value.competition.indexOf(s)==-1&&t.value.competition.length>2)return b.value.show("每幅作品最多投稿到三个分类"),!1;g.post(a.$util.settings.api+"/intelli/my/artwork/toggle/competition",JSON.stringify({sn:t.value.sn,cp:s}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&(t.value.competition.indexOf(s)>=0?t.value.competition.splice(t.value.competition.indexOf(s),1):t.value.competition.push(s))}).catch(function(o){console.log(o)})},D=s=>{if(!w.value)return w.value=!0,!1;g.post(a.$util.settings.api+"/intelli/my/artwork/remove",JSON.stringify({sn:t.value.sn}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&a.$util.gotoPage("gallery")}).catch(function(o){console.log(o)})},E=()=>{g.post(a.$util.settings.api+"/intelli/my/artwork/update",JSON.stringify({sn:t.value.sn,cp:JSON.stringify(n.value)}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.res=="ok"&&(C.value=!1,M())}).catch(function(s){console.log(s)})},H=s=>{p.value=s};return M(),(s,o)=>(i(),r(S,null,[e("div",oe,[t.value.sn?(i(),r("div",ne,[e("div",le,[e("div",ae,[e("a",{href:m(a).$util.settings.api+"/d/image/"+t.value.file,target:"_blank"},[e("img",{ref:"demo",src:m(a).$util.settings.api+"/d/image/"+t.value.file,class:"shadow-inner"},null,8,re)],8,ie)]),e("div",ue,[n.value.platform=="mj"?(i(),r("div",ce,"Midjourney")):d("",!0),n.value.platform=="sd"?(i(),r("div",de,"SD WebUI")):d("",!0),n.value.platform=="ot"?(i(),r("div",pe,"其它")):d("",!0),e("div",ve,c(n.value.seed?n.value.seed:"-"),1)])]),e("div",ge,[e("div",me,[e("div",fe,[e("div",he,c(t.value.param.title),1),e("div",xe,c(t.value.param.artist),1)]),e("button",{class:"flex items-center",onClick:o[0]||(o[0]=l=>T())},[f(m(X),{class:$([p.value&&k.value?"text-red-600":"","w-5 h-5 mr-2"])},null,8,["class"]),e("div",null,c(t.value.like),1)])]),!p.value||p.value&&u.value!="gallery"?(i(),r("div",_e,[(i(!0),r(S,null,z(t.value.competition,l=>(i(),r("div",{class:"bg-stone-300 px-1 m-1",key:l},c(A.value[l].split(" / ")[0]),1))),128))])):d("",!0),p.value&&u.value=="gallery"?(i(),r("div",ke,[(i(!0),r(S,null,z(A.value,(l,O)=>(i(),r("button",{key:O,class:$([t.value.competition.indexOf(O)>=0?"bg-stone-400":"bg-stone-300","px-1 m-1"]),onClick:xt=>P(O)},c(l.split(" / ")[0]),11,we))),128))])):d("",!0),e("div",be,c(t.value.param.prompt),1),e("div",ye,c(t.value.param.negative),1),e("div",$e,[e("div",je,[Ce,e("div",null,c(n.value.model?n.value.model:"-"),1)]),e("div",null,[Oe,e("div",null,c(n.value.scale?n.value.scale:"-"),1)])]),e("div",Se,[e("div",Be,[Ae,e("div",null,c(n.value.sampler?n.value.sampler:"-"),1)]),e("div",null,[Ne,e("div",null,c(n.value.step?n.value.step:"-"),1)])]),e("div",Ve,[w.value?(i(),r("button",{key:0,class:"p-2 rounded-full hover:bg-stone-300/50",onClick:o[1]||(o[1]=l=>w.value=!1)},[f(m(L),{class:"w-5 h-5"})])):d("",!0),w.value?(i(),r("button",{key:1,class:"p-2 rounded-full hover:bg-stone-300/50",onClick:o[2]||(o[2]=l=>D())},[f(m(Y),{class:"w-5 h-5"})])):d("",!0),e("button",{class:$([w.value?"text-red-600":"","p-2 rounded-full hover:bg-stone-300/50"]),onClick:o[3]||(o[3]=l=>w.value=!w.value)},[f(m(se),{class:"w-5 h-5"})],2),e("button",{class:"p-2 rounded-full hover:bg-stone-300/50 mr-2",onClick:o[4]||(o[4]=l=>C.value=!0)},[f(m(te),{class:"w-5 h-5"})])])])])):d("",!0)]),u.value?(i(),r("div",Ue,[e("button",{class:"bg-stone-200/50 p-3 rounded-full hover:bg-stone-300",onClick:o[5]||(o[5]=l=>V())},[f(m(Z),{class:"w-5 h-5 text-stone-600"})])])):d("",!0),u.value?(i(),r("div",Me,[e("button",{class:"bg-stone-200/50 p-3 rounded-full hover:bg-stone-300",onClick:o[6]||(o[6]=l=>U())},[f(m(ee),{class:"w-5 h-5 text-stone-600"})])])):d("",!0),f(R,{page:u.value,autohide:"true",signup:p.value,onUpdateStatus:H,onShowMessage:s.showMessage},null,8,["page","signup","onShowMessage"]),C.value?(i(),r("div",ze,[e("div",Le,[e("div",Je,[e("div",Te,[Pe,e("div",De,[x(e("input",{"onUpdate:modelValue":o[7]||(o[7]=l=>n.value.title=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.title]])])]),e("div",null,[Ee,e("div",He,[x(e("input",{"onUpdate:modelValue":o[8]||(o[8]=l=>n.value.artist=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.artist]])])])]),e("div",Ie,[Fe,e("div",We,[x(e("input",{"onUpdate:modelValue":o[9]||(o[9]=l=>n.value.prompt=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.prompt]])])]),e("div",Re,[qe,e("div",Ge,[x(e("input",{"onUpdate:modelValue":o[10]||(o[10]=l=>n.value.negative=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.negative]])])]),e("div",Ke,[Qe,e("div",Xe,[e("button",{class:$([n.value.platform=="mj"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:o[11]||(o[11]=l=>n.value.platform="mj")},"Midjourney",2),e("button",{class:$([n.value.platform=="sd"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:o[12]||(o[12]=l=>n.value.platform="sd")},"SD WebUI",2),e("button",{class:$([n.value.platform=="ot"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:o[13]||(o[13]=l=>n.value.platform="ot")},"其它",2)])]),e("div",Ye,[e("div",Ze,[et,e("div",tt,[x(e("input",{"onUpdate:modelValue":o[14]||(o[14]=l=>n.value.model=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.model]])])]),e("div",null,[st,e("div",ot,[x(e("input",{"onUpdate:modelValue":o[15]||(o[15]=l=>n.value.scale=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.scale]])])])]),e("div",nt,[e("div",lt,[at,e("div",it,[x(e("input",{"onUpdate:modelValue":o[16]||(o[16]=l=>n.value.sampler=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.sampler]])])]),e("div",null,[rt,e("div",ut,[x(e("input",{"onUpdate:modelValue":o[17]||(o[17]=l=>n.value.step=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.step]])])])]),e("div",ct,[e("div",dt,[pt,e("div",vt,[x(e("input",{"onUpdate:modelValue":o[18]||(o[18]=l=>n.value.seed=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.seed]])])]),e("div",gt,[e("button",{class:"py-2 px-5 text-lf font-bold bg-stone-800 hover:bg-stone-900",onClick:o[19]||(o[19]=l=>E())},"确认修改")])])]),e("div",mt,[ft,e("button",{onClick:o[20]||(o[20]=l=>C.value=!1)},[f(m(L),{class:"w-7 h-7"})])])])):d("",!0),f(q,{ref_key:"message",ref:b},null,512)],64))}},J=G(ht);J.config.globalProperties.$util=K;J.use(Q).mount("#app");
