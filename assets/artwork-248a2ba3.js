import{o as i,c as r,b as e,g as F,r as f,k as W,l as R,a as m,i as g,m as u,t as c,d as h,n as $,F as A,h as L,_ as q,w as x,v as _,p as J,f as G,e as K,u as Q,V as X}from"./index-695bf402.js";import{r as Y}from"./HeartIcon-d925011b.js";function Z(j,a){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12.75l6 6 9-13.5"})])}function ee(j,a){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})])}function te(j,a){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})])}function se(j,a){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})])}function oe(j,a){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})])}const ne={class:"fixed left-0 top-0 right-0 bottom-0 md:flex md:justify-center overflow-x-hidden overflow-y-scroll"},le=e("div",{class:"h-[120px] w-full md:hidden"},null,-1),ae={class:"flex justify-center"},ie={key:0,class:"md:flex md:justify-center md:items-center py-5"},re={class:"mr-0 md:mr-5"},ue={class:"w-[300px] bg-stone-100 p-2 shadow-xl"},ce=["href"],de=["src"],ve={class:"flex py-3 text-xs text-white"},pe={key:0,class:"bg-red-800/80 px-2 py-1"},fe={key:1,class:"bg-green-800/80 px-2 py-1"},me={key:2,class:"bg-blue-800/80 px-2 py-1"},ge={class:"bg-gray-400/80 px-2 py-1 text-black/80"},he={class:"w-[300px] text-stone-900/80 ml-0 mt-5 md:ml-5 md:mt-0"},xe={class:"flex items-center"},_e={class:"flex-1"},ke={class:"font-bold"},we={class:"text-sm"},be={key:0,class:"mt-2 text-xs flex"},ye={key:1,class:"mt-2 text-xs flex flex-wrap"},$e=["onClick"],je={key:2,class:"mt-2 text-xs text-stone-900/40"},Ce={class:"text-xs mt-5"},Oe={class:"text-xs mt-5 text-stone-900/50"},Se={class:"grid grid-cols-3 text-xs mt-5"},Be={class:"col-span-2"},Ae=e("div",{class:"text-stone-900/50"},"模型",-1),Ne=e("div",{class:"text-stone-900/50"},"文本强度",-1),Ve={class:"grid grid-cols-3 text-xs mt-5"},Me={class:"col-span-2"},Ue=e("div",{class:"text-stone-900/50"},"采样器",-1),ze=e("div",{class:"text-stone-900/50"},"步数",-1),Le={key:3,class:"text-xs mt-5 pb-5 text-stone-900/50 flex flex-row-reverse"},Je={key:0,class:"z-20 fixed top-0 bottom-0 left-0 w-[60px] flex flex-col justify-center items-center"},Te={key:1,class:"z-20 fixed top-0 bottom-0 right-0 w-[60px] flex flex-col justify-center items-center"},Pe={key:2,class:"z-50 fixed left-0 top-0 right-0 bottom-0 bg-black/80 text-stone-100/80"},De={class:"fixed w-full md:w-[600px] top-[80px] right-0 bottom-0 px-5 bg-stone-600 text-sm"},Ee={class:"mb-5 grid grid-cols-3 gap-2"},He={class:"col-span-2"},Ie=e("div",{class:"my-1"},"作品名称",-1),Fe={class:"bg-stone-700/80"},We=e("div",{class:"my-1"},"署名",-1),Re={class:"bg-stone-700/80"},qe={class:"mb-5"},Ge=e("div",{class:"my-1"},"提示词",-1),Ke={class:"bg-stone-700/80"},Qe={class:"mb-5"},Xe=e("div",{class:"my-1"},"负性提示词",-1),Ye={class:"bg-stone-700/80"},Ze={class:"mb-5"},et=e("div",{class:"my-1"},"平台或工具",-1),tt={class:"flex"},st={class:"mb-5 grid grid-cols-3 gap-2"},ot={class:"col-span-2"},nt=e("div",{class:"my-1"},"模型名称",-1),lt={class:"bg-stone-700/80"},at=e("div",{class:"my-1"},"文本强度",-1),it={class:"bg-stone-700/80"},rt={class:"mb-5 grid grid-cols-3 gap-2"},ut={class:"col-span-2"},ct=e("div",{class:"my-1"},"采样器",-1),dt={class:"bg-stone-700/80"},vt=e("div",{class:"my-1"},"步数",-1),pt={class:"bg-stone-700/80"},ft={class:"mb-5 grid grid-cols-3 gap-2 items-end"},mt={class:"col-span-2"},gt=e("div",{class:"my-1"},"随机种子",-1),ht={class:"bg-stone-700/80"},xt={class:"text-right"},_t={class:"fixed w-full md:w-[600px] top-0 right-0 h-[80px] flex items-center px-5 bg-stone-600"},kt=e("div",{class:"flex-1 text-lg font-bold"},"编辑作品信息",-1),wt={__name:"artwork",setup(j){const{proxy:a}=F(),v=f(!!a.$cookies.get("intelli-token")),N=a.$cookies.get("intelli-artwork"),d=f(a.$cookies.get("intelli-competition")),O=f(a.$cookies.get("intelli-competitions")),S=f(a.$cookies.get("intelli-artist")==a.$cookies.get("intelli-username")),t=f({}),k=f(!1),w=f(),b=f(!1),C=f(!1),n=f({title:"",artist:"",prompt:"",negative:"",platform:"mj",model:"",scale:7,sampler:"",step:20,seed:0});var p=[];W(()=>{window.addEventListener("keydown",V)}),R(()=>{window.removeEventListener("keydown",V)});function V(s){s.key=="ArrowRight"?U():s.key=="ArrowLeft"&&M()}const y=()=>{n.value.title=t.value.param.title,n.value.artist=t.value.param.artist,n.value.prompt=t.value.param.prompt,n.value.negative=t.value.param.negative,n.value.platform=t.value.param.platform,n.value.model=t.value.param.model,n.value.scale=t.value.param.scale,n.value.sampler=t.value.param.sampler,n.value.step=t.value.param.step,n.value.seed=t.value.param.seed},M=()=>{v.value?m.post(a.$util.settings.api+"/intelli/my/prev/artwork",JSON.stringify({sn:t.value.sn,cp:d.value}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.hasOwnProperty("sn")?(t.value=s.data,y(),k.value=p.indexOf(t.value.sn)!=-1,a.$cookies.set("intelli-artwork",t.value.sn)):w.value.show("前面没有了",1e3)}).catch(function(s){console.log(s)}):m.post(a.$util.settings.api+"/intelli/prev/artwork",JSON.stringify({sn:t.value.sn,cp:d.value}),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.hasOwnProperty("sn")?(t.value=s.data,y(),k.value=p.indexOf(t.value.sn)!=-1,a.$cookies.set("intelli-artwork",t.value.sn)):w.value.show("前面没有了",1e3)}).catch(function(s){console.log(s)})},U=()=>{v.value?m.post(a.$util.settings.api+"/intelli/my/next/artwork",JSON.stringify({sn:t.value.sn,cp:d.value}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.hasOwnProperty("sn")?(t.value=s.data,y(),k.value=p.indexOf(t.value.sn)!=-1,a.$cookies.set("intelli-artwork",t.value.sn)):w.value.show("后面没有了",1e3)}).catch(function(s){console.log(s)}):m.post(a.$util.settings.api+"/intelli/next/artwork",JSON.stringify({sn:t.value.sn,cp:d.value}),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.hasOwnProperty("sn")?(t.value=s.data,y(),k.value=p.indexOf(t.value.sn)!=-1,a.$cookies.set("intelli-artwork",t.value.sn)):w.value.show("后面没有了",1e3)}).catch(function(s){console.log(s)})},z=()=>{v.value?m.post(a.$util.settings.api+"/intelli/artwork2",JSON.stringify({sn:N}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){t.value=s.data.artwork,y(),t.value.competition.length&&!d.value&&(d.value=t.value.competition[0]),p=s.data.favorite,k.value=p.indexOf(t.value.sn)!=-1}).catch(function(s){console.log(s)}):m.post(a.$util.settings.api+"/intelli/artwork",JSON.stringify({sn:N}),{headers:{accept:"application/json","Content-Type":"application/json"}}).then(function(s){t.value=s.data,y(),t.value.competition.length&&!d.value&&(d.value=t.value.competition[0])}).catch(function(s){console.log(s)})},P=()=>{if(!v.value)return w.value.show("您尚未登录，请登录后试试看"),!1;m.post(a.$util.settings.api+"/intelli/artwork/toggle/like",JSON.stringify({sn:t.value.sn}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.res=="ok"&&(p.indexOf(t.value.sn)==-1?(p.push(t.value.sn),k.value=!0,t.value.like++):(p.splice(p.indexOf(t.value.sn),1),k.value=!1,t.value.like--))}).catch(function(s){console.log(s)})},D=s=>{if(t.value.competition.indexOf(s)==-1&&t.value.competition.length>2)return w.value.show("每幅作品最多投稿到三个分类"),!1;m.post(a.$util.settings.api+"/intelli/my/artwork/toggle/competition",JSON.stringify({sn:t.value.sn,cp:s}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(o){if(o.data.res=="ok"){var l="";t.value.competition.indexOf(s)>=0?l="退出了":l="参加了",w.value.show("这个作品"+l+" "+O.value[s].split(" / ")[0]+"类 竞赛"),t.value.competition.indexOf(s)>=0?t.value.competition.splice(t.value.competition.indexOf(s),1):t.value.competition.push(s)}}).catch(function(o){console.log(o)})},E=s=>{if(!b.value)return b.value=!0,!1;m.post(a.$util.settings.api+"/intelli/my/artwork/remove",JSON.stringify({sn:t.value.sn}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(o){o.data.res=="ok"&&a.$util.gotoPage("gallery")}).catch(function(o){console.log(o)})},H=()=>{m.post(a.$util.settings.api+"/intelli/my/artwork/update",JSON.stringify({sn:t.value.sn,cp:JSON.stringify(n.value)}),{headers:{Authorization:"Bearer "+a.$cookies.get("intelli-token"),accept:"application/json","Content-Type":"application/json"}}).then(function(s){s.data.res=="ok"&&(C.value=!1,z())}).catch(function(s){console.log(s)})},I=s=>{v.value=s};return z(),(s,o)=>(i(),r(A,null,[e("div",ne,[le,e("div",ae,[t.value.sn?(i(),r("div",ie,[e("div",re,[e("div",ue,[e("a",{href:g(a).$util.settings.api+"/d/image/"+t.value.file,target:"_blank"},[e("img",{ref:"demo",src:g(a).$util.settings.api+"/d/image/"+t.value.file,class:"shadow-inner"},null,8,de)],8,ce)]),e("div",ve,[n.value.platform=="mj"?(i(),r("div",pe,"Midjourney")):u("",!0),n.value.platform=="sd"?(i(),r("div",fe,"SD WebUI")):u("",!0),n.value.platform=="ot"?(i(),r("div",me,"其它")):u("",!0),e("div",ge,c(n.value.seed?n.value.seed:"-"),1)])]),e("div",he,[e("div",xe,[e("div",_e,[e("div",ke,c(t.value.param.title),1),e("div",we,c(t.value.param.artist),1)]),e("button",{class:"flex items-center",onClick:o[0]||(o[0]=l=>P())},[h(g(Y),{class:$([v.value&&k.value?"text-red-600":"","w-5 h-5 mr-2"])},null,8,["class"]),e("div",null,c(t.value.like),1)])]),v.value?u("",!0):(i(),r("div",be,[(i(!0),r(A,null,L(t.value.competition,l=>(i(),r("div",{class:"bg-stone-300 px-1 m-1",key:l},c(O.value[l].split(" / ")[0]),1))),128))])),v.value&&S.value?(i(),r("div",ye,[(i(!0),r(A,null,L(O.value,(l,B)=>(i(),r("button",{key:B,class:$([t.value.competition.indexOf(B)>=0?"bg-stone-400":"bg-stone-300","px-1 m-1"]),onClick:bt=>D(B)},c(l.split(" / ")[0]),11,$e))),128))])):u("",!0),v.value&&S.value?(i(),r("div",je,"* 点击上面分类可参加或退出相应竞赛类别")):u("",!0),e("div",Ce,c(t.value.param.prompt),1),e("div",Oe,c(t.value.param.negative),1),e("div",Se,[e("div",Be,[Ae,e("div",null,c(n.value.model?n.value.model:"-"),1)]),e("div",null,[Ne,e("div",null,c(n.value.scale?n.value.scale:"-"),1)])]),e("div",Ve,[e("div",Me,[Ue,e("div",null,c(n.value.sampler?n.value.sampler:"-"),1)]),e("div",null,[ze,e("div",null,c(n.value.step?n.value.step:"-"),1)])]),S.value?(i(),r("div",Le,[b.value?(i(),r("button",{key:0,class:"p-2 rounded-full hover:bg-stone-300/50",onClick:o[1]||(o[1]=l=>b.value=!1)},[h(g(J),{class:"w-5 h-5"})])):u("",!0),b.value?(i(),r("button",{key:1,class:"p-2 rounded-full hover:bg-stone-300/50",onClick:o[2]||(o[2]=l=>E())},[h(g(Z),{class:"w-5 h-5"})])):u("",!0),e("button",{class:$([b.value?"text-red-600":"","p-2 rounded-full hover:bg-stone-300/50"]),onClick:o[3]||(o[3]=l=>b.value=!b.value)},[h(g(oe),{class:"w-5 h-5"})],2),e("button",{class:"p-2 rounded-full hover:bg-stone-300/50 mr-2",onClick:o[4]||(o[4]=l=>C.value=!0)},[h(g(se),{class:"w-5 h-5"})])])):u("",!0)])])):u("",!0)])]),d.value?(i(),r("div",Je,[e("button",{class:"bg-stone-200/50 p-3 rounded-full hover:bg-stone-300",onClick:o[5]||(o[5]=l=>M())},[h(g(ee),{class:"w-5 h-5 text-stone-600"})])])):u("",!0),d.value?(i(),r("div",Te,[e("button",{class:"bg-stone-200/50 p-3 rounded-full hover:bg-stone-300",onClick:o[6]||(o[6]=l=>U())},[h(g(te),{class:"w-5 h-5 text-stone-600"})])])):u("",!0),h(q,{page:d.value,signup:v.value,onUpdateStatus:I,onShowMessage:s.showMessage},null,8,["page","signup","onShowMessage"]),C.value?(i(),r("div",Pe,[e("div",De,[e("div",Ee,[e("div",He,[Ie,e("div",Fe,[x(e("input",{"onUpdate:modelValue":o[7]||(o[7]=l=>n.value.title=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.title]])])]),e("div",null,[We,e("div",Re,[x(e("input",{"onUpdate:modelValue":o[8]||(o[8]=l=>n.value.artist=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.artist]])])])]),e("div",qe,[Ge,e("div",Ke,[x(e("input",{"onUpdate:modelValue":o[9]||(o[9]=l=>n.value.prompt=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.prompt]])])]),e("div",Qe,[Xe,e("div",Ye,[x(e("input",{"onUpdate:modelValue":o[10]||(o[10]=l=>n.value.negative=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.negative]])])]),e("div",Ze,[et,e("div",tt,[e("button",{class:$([n.value.platform=="mj"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:o[11]||(o[11]=l=>n.value.platform="mj")},"Midjourney",2),e("button",{class:$([n.value.platform=="sd"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:o[12]||(o[12]=l=>n.value.platform="sd")},"SD WebUI",2),e("button",{class:$([n.value.platform=="ot"?"bg-stone-800":"","px-2 py-1 bg-stone-700/80 hover:bg-stone-800/70"]),onClick:o[13]||(o[13]=l=>n.value.platform="ot")},"其它",2)])]),e("div",st,[e("div",ot,[nt,e("div",lt,[x(e("input",{"onUpdate:modelValue":o[14]||(o[14]=l=>n.value.model=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.model]])])]),e("div",null,[at,e("div",it,[x(e("input",{"onUpdate:modelValue":o[15]||(o[15]=l=>n.value.scale=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.scale]])])])]),e("div",rt,[e("div",ut,[ct,e("div",dt,[x(e("input",{"onUpdate:modelValue":o[16]||(o[16]=l=>n.value.sampler=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.sampler]])])]),e("div",null,[vt,e("div",pt,[x(e("input",{"onUpdate:modelValue":o[17]||(o[17]=l=>n.value.step=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.step]])])])]),e("div",ft,[e("div",mt,[gt,e("div",ht,[x(e("input",{"onUpdate:modelValue":o[18]||(o[18]=l=>n.value.seed=l),type:"text",class:"w-full text-sm bg-transparent border-none focus:ring-0"},null,512),[[_,n.value.seed]])])]),e("div",xt,[e("button",{class:"py-2 px-5 text-lf font-bold bg-stone-800 hover:bg-stone-900",onClick:o[19]||(o[19]=l=>H())},"确认修改")])])]),e("div",_t,[kt,e("button",{onClick:o[20]||(o[20]=l=>C.value=!1)},[h(g(J),{class:"w-7 h-7"})])])])):u("",!0),h(G,{ref_key:"message",ref:w},null,512)],64))}},T=K(wt);T.config.globalProperties.$util=Q;T.use(X).mount("#app");
